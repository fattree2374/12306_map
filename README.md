# 12306_map
这是一个使用python爬取12306信息，并且用R进行地图可视化的项目

`接下来的任务`：
- [ ] 取一个区间进行三个函数的测试，测试成功则从json数据中国提取数据进行单天爬取

- [ ] 之后还要把代码改成扩展性好的，然后把封装好的函数放到我的笔记里面
- [ ] 在CODING文件夹中的TEST3试改了一个函数，但没有测试，同时我发现notebook在长期使用上不太舒服，毕竟我需要一个个运行，哦对了，有一次运行的按钮，有些常量我没有整理好，需要作为全局变量。
- [ ] 尝试使用代理，看看能不能绕过爬虫的禁止访问




## 已完成的任务或解决的错误
- [x] 请求的时候，跳到了一个网站http://www.12306.cn/mormhweb/logFiles/error.html，并不知道为什么，headers也改过了...
    * 原因是给输入变量赋值的时候有两个变量写成一个，覆盖了原来的值，因此就输入错误。
- [x] 注意下query_price里面的seat_type的意义
    * 这个参数在第一个查询内有返回
- [x] 发现一个没有捕捉到的错误：调用query函数的时候，会不定期返回错误数据，这样解析不了，解决办法可以选择轮询，直到返回正确数据；或者我先尝试下改headers能不能解决问题
    * 已解决，原来使用递归失败是因为没有return结果
- [x] 补充一个写到本地CSV，一边添加的，不然数量太多占用太多内存
- [x] 补充一个日志功能，便于事后调制，同时这个日志主体要封装得便于扩展，把它列入我的常用模块和函数，以便以后写程序直接加上。
    * 遇到的错误是log方面有局域的问题，我引用了一个封装类，结果出错。
- [x] 增加多进程
- [x] 单天爬取成功之后，测试稳定性，并且部署到服务器
    * 遇到的错误是一直nohup不了，因为明明之前是跑得了多进程的，然后我就检测文件到底能不能运行，发现现在已经跑不了多进程了，估计是一台好机器划出一核给我做服务器，然后之前我跑程序，跑了多进程被发现，就给我加了限制，我一用多进程，就killed我的程序。最后我改成单进程就跑起来了，但是真的慢...